webpackJsonp([6],{gyBK:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("fZjL"),i=s.n(a),r=s("AX/i"),o=s("orfX"),l=s("C7S3"),n=s("Kkag");var c={0:{type:0,color:"dark",label:"全部"},2:{type:2,color:"text-info",label:"截屏"},3:{type:3,color:"text-primary",label:"命令"}},d={1:{type:1,color:"text-primary",label:"连接中"},2:{type:2,color:"dark",label:"已断开"}},h={name:"comp_xss_catalog",mixins:[r.a],data:function(){return{search_key:"",xss_type:0,dataList:[],dataCount:0,command_request_mode:{}}},computed:{footer_can_turn_left:function(){return!(this.page<=1)},footer_can_turn_right:function(){return!(this.page*this.rowsPerPage>this.dataCount)},server_ip:function(){return this.$store.state.user.ip},user_id:function(){return this.$store.state.user.id}},methods:{render_search:function(t){var e=this;return t("div",{staticClass:"q-mb-sm"},[t(l.a,{props:{value:this.search_key,placeholder:"按域名搜索",width:245},on:{input:function(t){e.search_key=t,e.$nextTick(e.refresh_catalog)}}})])},render_type_btn:function(t,e){var s=this;return t("div",{staticClass:"q-ml-md",style:{marginTop:"5px"}},[t("q-btn",{staticClass:"no-shadow",props:{label:e.label,color:"deep-orange-1",textColor:this.xss_type===e.type?"deep-orange":e.color,flat:this.xss_type!==e.type},nativeOn:{click:function(){s.xss_type=e.type,s.refresh_catalog()}}})])},render_table_header:function(t){return 2===this.xss_type?t("thead",[t("tr",[t("th",{staticClass:"text-left"},"域名"),t("th",{staticClass:"text-left"},"攻击类型"),t("th",{staticClass:"text-left"},"地址"),t("th",{staticClass:"text-left"},"Cookie"),t("th",{staticClass:"text-left"},"站点截图"),t("th",{staticClass:"text-left"},"创建时间"),t("th",{staticClass:"text-left"},"操作")])]):3===this.xss_type?t("thead",[t("tr",[t("th",{staticClass:"text-left"},"域名"),t("th",{staticClass:"text-left"},"攻击类型"),t("th",{staticClass:"text-left"},"地址"),t("th",{staticClass:"text-left"},"Cookie"),t("th",{staticClass:"text-left"},"状态"),t("th",{staticClass:"text-left"},"输入命令"),t("th",{staticClass:"text-left"},"创建时间"),t("th",{staticClass:"text-left"},"操作")])]):t("thead",[t("tr",[t("th",{staticClass:"text-left"},"域名"),t("th",{staticClass:"text-left"},"攻击类型"),t("th",{staticClass:"text-left"},"地址"),t("th",{staticClass:"text-left"},"Cookie"),t("th",{staticClass:"text-left"},"站点截图"),t("th",{staticClass:"text-left"},"状态"),t("th",{staticClass:"text-left"},"输入命令"),t("th",{staticClass:"text-left"},"创建时间"),t("th",{staticClass:"text-left"},"操作")])])},render_table_row:function(t,e){var s=this;return t("tr",{style:{height:"120px"}},[t("td",{staticClass:"text-left"},[t("div",{style:{fontWeight:"700"}},o.a.ofNullable(e.domain).orElse("--"))]),t("td",{staticClass:"text-left"},[t("div",{staticClass:c[e.type].color||"text-tertiary",style:{fontWeight:"700"}},o.a.ofNullable(c[e.type].label).orElse("--"))]),t("td",{staticClass:"text-left"},[t("div",{style:{fontWeight:"700",width:"200px",wordWrap:"break-word",whiteSpace:"normal"}},o.a.ofNullable(e.url).orElse("--"))]),t("td",{staticClass:"text-left"},[t("div",{style:{width:"300px",fontWeight:"700",wordWrap:"break-word",whiteSpace:"normal"}},o.a.ofNullable(decodeURIComponent(e.cookie)).orElse("--"))]),2===this.xss_type||0===this.xss_type?t("td",{staticClass:"text-left"},[null!=e.img?t("div",{staticClass:"q-ma-sm",style:{width:"180px",height:"120px"},on:{click:function(){return s.showImgModal(e)}}},[t("img",{staticClass:"cursor-pointer",style:{width:"100%",height:"100%"},attrs:{src:e.img}})]):null]):null,3===this.xss_type||0===this.xss_type?t("td",{staticClass:"text-left"},[t("div",{staticClass:d[e.status].color||"text-tertiary",style:{fontWeight:"700"}},o.a.ofNullable(d[e.status].label).orElse("--"))]):null,3===this.xss_type||0===this.xss_type?t("td",{staticClass:"text-left"},[e.type===c[3].type&&1===e.status?t("div",{staticClass:"nowrap row ellipsis  pp-radius-1 pp-border-5",style:{width:"450px",height:"80px",marginTop:"20px",marginBottom:"20px",verticalAlign:"middle",fontWeight:"700"}},[t("div",{staticClass:"col-10 q-ml-sm",width:"200px"},[t("q-input",{staticClass:"text-dark shadow-0",attrs:{rows:3},props:{color:"grey-1",type:"textarea",maxHeight:80,value:e.command,placeholder:"请输入要执行的命令",hideUnderline:!0},on:{input:function(t){return s.command_request_mode[e.id]=t}}})]),t("div",{style:{float:"right"}},[t("q-btn",{staticClass:"",style:{marginTop:"40px"},props:{color:"primary",flat:!0,icon:"send"},nativeOn:{click:function(){var t,a,i;(t=e.id,a=s.command_request_mode[e.id],i={command:a},Object(n.a)({url:"/api/xssinfos/"+t,method:"patch",data:i})).then(function(t){1===t.status&&s.$q.notify({type:"positive",message:"更新命令成功！"})}).catch(function(){return s.$q.err("更新命令异常!")})}}})])]):null]):null,t("td",{staticClass:"text-left"},[t("div",{style:{fontWeight:"700"}},o.a.ofNullable(e.create_time).orElse("--"))]),t("td",{staticClass:"text-left"},[t("q-btn",{staticClass:"text-primary text-weight-bold cursor-pointer",props:{label:"删除",flat:!0},on:{click:function(){var t;(t=e.id,Object(n.a)({url:"/api/xssinfos/"+t,method:"delete"})).then(function(t){s.refresh_catalog()}).catch(function(t){})}}})])])},render_table_body:function(t){var e=this;return this.dataList.map(function(t){e.command_request_mode[t.id]=t.command}),t("tbody",{staticClass:"text-tertiary"},[this.dataList.map(function(s){return[e.render_table_row(t,s)]})])},render_table_footer:function(t){var e=this;return t("div",{staticClass:"q-table-bottom nowrap row items-center justify-end",style:{width:"100%"}},[t("div",{staticClass:""},[]),t("div",{staticClass:"q-table-control"},[t("span",{staticClass:"q-table-bottom-item"},[((this.page-1)*this.rowsPerPage>this.dataCount?this.dataCount:(this.page-1)*this.rowsPerPage)+"-"+(this.page*this.rowsPerPage>this.dataCount?this.dataCount:this.page*this.rowsPerPage)+" of "+this.dataCount]),t("q-btn",{props:{icon:"chevron_left",flat:!0,color:"primary",round:!0,size:"md",disable:!this.footer_can_turn_left},on:{click:function(){e.pagination_ctl.page-=1,e.refresh_catalog()}}}),t("q-btn",{props:{icon:"chevron_right",flat:!0,color:"primary",round:!0,size:"md",disable:!this.footer_can_turn_right},on:{click:function(){e.pagination_ctl.page+=1,e.refresh_catalog()}}})])])},render_xss_list_table:function(t){return t("table",{staticClass:"q-table q-table-horizontal-separator no-shadow"},[this.render_table_header(t),this.render_table_body(t)])},render_xss_template_div:function(t){var e=this;return t("div",{staticClass:"text-left font-14 bg-grey-1 q-pa-md text-tertiary text-weight-bold row no-wrap",style:{border:"1px solid var(--q-color-grey-3)"}},[t("div",{staticClass:"row no-wrap q-mr-lg"},[t("span",{staticClass:"font-12"},["截图攻击注入链接："]),t("span",{staticClass:"text-primary text-weight-bold cursor-pointer",on:{click:function(){e.copy_value("http://"+e.$store.state.user.ip+":8080/api/xss/screen.js?id="+e.user_id)}}},["http://"+this.$store.state.user.ip+":8080/api/xss/screen.js?id="+this.user_id])]),t("div",{staticClass:"row no-wrap q-ml-lg"},[t("span",{staticClass:"font-12"},["命令攻击注入链接："]),t("span",{staticClass:"text-primary text-weight-bold cursor-pointer",on:{click:function(){e.copy_value("http://"+e.$store.state.user.ip+":8080/api/xss/command.js?id="+e.user_id)}}},["http://"+this.$store.state.user.ip+":8080/api/xss/command.js?id="+this.user_id])]),t("div",{},[])])},copy_value:function(t){var e=this;this.$copyText(t).then(function(){e.$q.ok("已经复制到粘贴板！")},function(){e.$q.err("复制失败！")})},request:function(){this.refresh_catalog()},refresh_catalog:function(){var t,e,s,a,i=this;(t=this.search_key,e=this.page,s=this.xss_type,a={searchKey:t,pageNum:e,type:s},Object(n.a)({url:"/api/xssinfos/search",method:"get",params:a})).then(function(t){i.dataList=t.data.dataList||[],i.dataCount=t.data.count||0}).catch(function(){return i.$q.err("获取XSS列表异常")})},showImgModal:function(t){this.$q.ppDialogBase(function(e){return e("div",{staticClass:"bg-grey-3 relative-position pp-radius-1",style:{padding:"4px 4px 2px 4px"}},[e("img",{staticClass:"pp-radius-1 pp-border-5",style:{height:"auto",width:"auto",maxHeight:"90vh",maxWidth:"90vw"},attrs:{src:t.img}}),e("div",{staticClass:"absolute flex justify-center absolute-bottom",style:{transform:"translateY(85%)"}},[])])},{noBackdropDismiss:!1,noEscDismiss:!1})}},render:function(t){var e=this;return t("div",{staticClass:"q-ml-md q-mr-md"},[t("div",{staticClass:"row col-12 flex q-pt-md"},[this.render_search(t),t("div",{staticClass:"row q-ml-md"},[i()(c).map(function(s){return[e.render_type_btn(t,c[s])]})])]),this.render_xss_template_div(t),this.render_xss_list_table(t),this.render_table_footer(t)])}};e.default={name:"xss_list_index",data:function(){return{}},methods:{},render:function(t){return t("div",{},[t(h,{ref:"CompXssListCatalog"})])}}}});
//# sourceMappingURL=6.7b9ae587fad961ccb980.js.map